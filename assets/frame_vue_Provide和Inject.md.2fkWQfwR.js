import{_ as s,c as i,o as a,V as n}from"./chunks/framework.hxTji2_l.js";const g=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"frame/vue/Provideå’ŒInject.md","filePath":"frame/vue/Provideå’ŒInject.md","lastUpdated":1716774423000}'),e={name:"frame/vue/Provideå’ŒInject.md"},p=n(`<blockquote><p>åŸæ–‡ï¼š <a href="https://juejin.cn/post/7267487352455921723" target="_blank" rel="noreferrer">https://juejin.cn/post/7267487352455921723</a></p></blockquote><p>ä¸¤ä¸ª<code>inject</code>å·¥å…·å‡½æ•°è½»æ¾è§£å†³<strong>ä¸¥æ ¼æ³¨å…¥</strong>å’Œ<strong>Hook è¿”å›å€¼é€ä¼ </strong>é—®é¢˜ï¼</p><p><img src="https://qn.huat.xyz/mac/202309021950240.awebp" alt="image.png"></p><p><img src="https://qn.huat.xyz/mac/202309021950795.awebp" alt="image.png"></p><h2 id="ç—›è‹¦çš„ç»å†" tabindex="-1">ç—›è‹¦çš„ç»å† <a class="header-anchor" href="#ç—›è‹¦çš„ç»å†" aria-label="Permalink to &quot;ç—›è‹¦çš„ç»å†&quot;">â€‹</a></h2><p>è‡ªä»ä½¿ç”¨äº†<code>Provide/Inject</code>ä»£ç çš„ç»„ç»‡æ–¹å¼æ›´åŠ çµæ´»äº†ï¼Œä½†æ˜¯è¿™ä¸ª<strong>çµæ´»æ€§çš„å¢åŠ ä¼´éšç€ä»£ç å®¹é”™æ€§çš„é™ä½</strong>ã€‚æˆ‘ç›¸ä¿¡åªè¦æ˜¯çœŸçš„åœ¨é¡¹ç›®ä¸­å¼•å…¥<code>Provide/Inject</code>çš„åŒå­¦ï¼Œä¸€å®šä¸€å®šæœ‰è¿‡æˆ–è€…æ­£åœ¨ç»å†ä¸‹é¢çš„çŠ¶å†µï¼š</p><ul><li>ğŸ˜¢ æ³¨å…¥åï¼ˆInjection keyï¼‰ç»å¸¸æ‹¼é”™ï¼Œåˆæˆ–è€…æ³¨å…¥åå¤ªå¤šå¯¼è‡´æ³¨å…¥åå–åå›°éš¾(ç¨‹åºå‘˜é€šç—…)</li><li>ğŸ¤¨ ä¸ºäº†å¼„æ¸…æ¥š<code>inject()</code>æ³¨å…¥çš„æ˜¯å•¥ï¼Œä¸å¾—ä¸æ‰¾åˆ°å¯¹åº”<code>provide()</code></li><li>ğŸ˜“ å¦ä¸€ç§æƒ…å†µæ˜¯é‡å¤<code>provide()</code>åŒä¸€å€¼ï¼Œå¯¼è‡´ Injection è¦†ç›–</li><li>ğŸ¥´ ä½¿ç”¨<code>inject()</code>æ—¶ç¥–å…ˆé“¾ä¸Šæœªå¿…å­˜åœ¨å¯¹åº”çš„<code>provide()</code>ï¼Œä¸å¾—ä¸åšç©ºå€¼å¤„ç†æˆ–é»˜è®¤å€¼å¤„ç†</li><li>ğŸ˜‘ åœ¨ hook ä¸­ä½¿ç”¨<code>provide()</code>ï¼Œä½†æ˜¯è°ƒç”¨ hook çš„ç»„ä»¶æ— æ³•<code>inject()</code>è¿™ä¸ª hook çš„<code>provide()</code></li><li>...</li></ul><h2 id="provide-inject-è§£å†³äº†ä»€ä¹ˆé—®é¢˜" tabindex="-1">Provide/Inject è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ <a class="header-anchor" href="#provide-inject-è§£å†³äº†ä»€ä¹ˆé—®é¢˜" aria-label="Permalink to &quot;Provide/Inject è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ&quot;">â€‹</a></h2><p><a href="https://link.juejin.cn/?target=" target="_blank" rel="noreferrer">ä¾èµ–æ³¨å…¥|Vue.js</a>ä¸­æåˆ°<code>Provide/Inject</code>è¿™ä¸¤ä¸ª API ä¸»è¦æ˜¯ç”¨æ¥è§£å†³<strong>Prop é€çº§é€ä¼ é—®é¢˜</strong>ï¼ˆå°±åƒä¸‹é¢è¿™æ ·ï¼‰</p><p><img src="https://qn.huat.xyz/mac/202309021950533.awebp" alt="image.png"></p><p>å¼•å…¥<code>Provide/Inject</code>å<code>Prop</code>å°±å¯ä»¥ç›´æ¥ä¼ å…¥åˆ°åä»£ç»„ä»¶ï¼ˆå°±åƒä¸‹é¢è¿™æ ·ï¼‰</p><p><img src="https://qn.huat.xyz/mac/202309021950149.awebp" alt="image.png"></p><p>æ ¹ç»„ä»¶ä¸­é€šè¿‡<code>provide</code>æä¾›æ³¨å…¥å€¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { provide } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* æ³¨å…¥å */</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;account&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/* å€¼ */</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;youth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åä»£ç»„ä»¶ä¸­é€šè¿‡<code>inject</code>è·å–ç¥–å…ˆç»„ä»¶æ³¨å…¥çš„å€¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { inject } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;account&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å½“åªæ˜¯åœ¨é¡¹ç›®ä¸­å°èŒƒå›´çš„ä½¿ç”¨<code>provide</code>å’Œ<code>inject</code>æ—¶ï¼Œä¸Šé¢ç¤ºä¾‹çš„å†™æ³•æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯å¦‚æœé¡¹ç›®å·¥ç¨‹è¾ƒå¤§ï¼Œä»£ç é‡ä¹Ÿå¤šçš„æƒ…å†µä¸‹ï¼Œå°±ä¼šå‡ºç°ä¸€äº›é—®é¢˜ã€‚</p><h2 id="æ³¨å…¥åå†²çª" tabindex="-1">æ³¨å…¥åå†²çª <a class="header-anchor" href="#æ³¨å…¥åå†²çª" aria-label="Permalink to &quot;æ³¨å…¥åå†²çª&quot;">â€‹</a></h2><p>é—®é¢˜æ˜¯å¦‚ä½•ä¿è¯<code>account</code>ä¸ä¼šè¢«å…¶ä»–ä¸šåŠ¡ç»„ä»¶è¦†ç›–ï¼Ÿä¾‹å¦‚å¦‚æœæŸä¸ªä¸šåŠ¡ç»„ä»¶ä¹Ÿæä¾›äº†<code>account</code>çš„ä¿¡æ¯ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š</p><p><img src="https://qn.huat.xyz/mac/202309021950727.awebp" alt="image.png"></p><p>ä¸­é—´å±‚çš„<code>ParentView</code>ç»„ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ç»„ä»¶ï¼Œä¹Ÿæä¾›äº†<code>account</code>æ•°æ®ï¼Œè¿™é‡Œçš„<code>account</code>å¯èƒ½æ˜¯åˆ—è¡¨é€‰ä¸­çš„ç”¨æˆ·ï¼Œè€Œ<code>Main</code>ä¸­æä¾›çš„æ˜¯å½“å‰ç”¨æˆ·ã€‚åœ¨<code>DeepChild</code>ç»„ä»¶ä¸­å¯èƒ½å³éœ€è¦å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œåˆéœ€è¦åˆ—è¡¨é€‰ä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè€Œç›®å‰<code>DeepChild</code>ä¸­åªèƒ½è·å–åˆ°<code>ParentView</code>æä¾›çš„é€‰ä¸­ç”¨æˆ·ä¿¡æ¯ã€‚</p><blockquote><p>å½“ç„¶è¿™ç§ä¸šåŠ¡åœºæ™¯æœ‰å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼Œè¿™é‡Œå…ˆè®¤ä¸ºåªèƒ½é€šè¿‡<code>provide/inject</code>è§£å†³ï¼ˆä¸æ å“ˆ ğŸŒï¼‰</p></blockquote><p>å½“ç„¶æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨<code>ParentView</code>ä¸­å°†æ³¨å…¥åæ”¹å†™ä¸º<code>selectAccount</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä¸­é—´å±‚è¿˜æœ‰å…¶ä»–çš„ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶ä¹Ÿæœ‰<code>selectAccount</code>å‘¢ï¼Ÿ</p><h3 id="å®è·µæ–¹æ¡ˆ" tabindex="-1">å®è·µæ–¹æ¡ˆ <a class="header-anchor" href="#å®è·µæ–¹æ¡ˆ" aria-label="Permalink to &quot;å®è·µæ–¹æ¡ˆ&quot;">â€‹</a></h3><p>åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªåä¸º<code>injection-key.ts</code>çš„æ–‡ä»¶ï¼Œæˆ‘ä¹ æƒ¯å°†è¯¥æ–‡ä»¶åˆ›å»ºä¸º<code>src/constants/injection-key.ts</code>ã€‚è¿™æ ·åœ¨è¯¥æ–‡ä»¶ä¸­ç»Ÿä¸€ç®¡ç†é¡¹ç›®ä¸‹çš„æ³¨å…¥åï¼Œå¹¶ä¸”<strong>ä½¿ç”¨<code>Symbol</code>æ¥åˆ›å»ºæ³¨å…¥åï¼Œæ¥å›é¿å–åå†²çª</strong></p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CurAccountKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;account&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AuthAccountKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;account&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ç”¨æ³•ç¤ºä¾‹ï¼š</p><p><code>Main.vue</code>:</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">import { provide } from &#39;vue&#39;; import { CurAccountKey } from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;@/constants/injectionKeys&#39;; const user = reactive({ id: 1, name: &#39;youth&#39; });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">provide(CurAccountKey, user);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>ParentView.vue</code>:</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">import { provide } from &#39;vue&#39;; import { AuthAccountKey } from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;@/constants/injectionKeys&#39;; const user = reactive({ id: 1, name: &#39;John Doe&#39; });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">provide(AuthAccountKey, user);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>DeepChild.vue</code>:</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">import { inject } from &#39;vue&#39;; import { AuthAccountKey, CurAccountKey } from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;@/constants/injectionKeys&#39;; const curAccount = inject(CurAccountKey); const</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">authAccount = inject(AuthAccountKey);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="æ³¨å…¥æç¤º" tabindex="-1">æ³¨å…¥æç¤º <a class="header-anchor" href="#æ³¨å…¥æç¤º" aria-label="Permalink to &quot;æ³¨å…¥æç¤º&quot;">â€‹</a></h2><p>ä½†æ˜¯ä½¿ç”¨<code>inject(CurAccountKey)</code>ä¼šä»£ç ä»€ä¹ˆæ ·çš„æ•°æ®ï¼Ÿè¿™å°±ä¸å¾—ä¸å…¨å±€æŸ¥æ‰¾<code>CurAccountKey</code>çš„<code>provide</code>äº†ã€‚è¿™ç§çš„ä½¿ç”¨ä½“éªŒååˆ†ä¸å¥½ï¼Œè¿™æ—¶ Vue å®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨ TSã€‚</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { inject } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { AuthAccountKey, CurAccountKey } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/constants/injectionKeys&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> curAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curAccount.name; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// curAccountå­˜åœ¨nameå—ï¼Ÿ</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="å®è·µæ–¹æ¡ˆ-1" tabindex="-1">å®è·µæ–¹æ¡ˆ <a class="header-anchor" href="#å®è·µæ–¹æ¡ˆ-1" aria-label="Permalink to &quot;å®è·µæ–¹æ¡ˆ&quot;">â€‹</a></h3><p><a href="./">Vue|ä¸º provide / inject æ ‡æ³¨ç±»å‹</a>ä¸­æåˆ°äº†<code>InjectionKey</code>ç±»å‹ï¼Œ<strong>ä½¿ç”¨ TS å’Œ<code>InjectionKey</code>å¯ä»¥æœ‰æ•ˆè§£å†³ç±»å‹æç¤ºé—®é¢˜</strong></p><p><code>src/types.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Account</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>src/constants/injection-key.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { InjectionKey } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Account } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/types&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> CurAccountKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InjectionKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Account</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;account&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>Main.vue</code>:</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">import { provide } from &#39;vue&#39;; import { CurAccountKey } from</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;@/constants/injectionKeys&#39;; const user = reactive({ id: 1, name: &#39;youth&#39; });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">provide(CurAccountKey, &#39;name: youth&#39;); // âŒ provide(CurAccountKey, user); // ğŸ’¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>DeepChild.vue</code>:</p><div class="language-vue vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">const curAccount = inject(CurAccountKey); curAccount?.age; // âŒ curAccount?.id;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">// ğŸ’¯</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="ä¸¥æ ¼æ³¨å…¥" tabindex="-1">ä¸¥æ ¼æ³¨å…¥ <a class="header-anchor" href="#ä¸¥æ ¼æ³¨å…¥" aria-label="Permalink to &quot;ä¸¥æ ¼æ³¨å…¥&quot;">â€‹</a></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>inject</code>Â  å‡è®¾ä¼ å…¥çš„æ³¨å…¥åä¼šè¢«æŸä¸ªç¥–å…ˆé“¾ä¸Šçš„ç»„ä»¶æä¾›ã€‚å¦‚æœè¯¥æ³¨å…¥åçš„ç¡®æ²¡æœ‰ä»»ä½•ç»„ä»¶æä¾›ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªè¿è¡Œæ—¶è­¦å‘Š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> curAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curAccount?.id;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å½“ç„¶æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶ä¸æ˜¯è¦æ±‚å¿…é¡»åœ¨ç¥–å…ˆé“¾ä¸Šæä¾›ï¼Œè¿™æ—¶å€™ Vue å®˜æ–¹æ¨èæˆ‘ä»¬ä½¿ç”¨é»˜è®¤å€¼æ¥è§£å†³ç¥–å…ˆé“¾æœªæä¾›å€¼çš„æƒ…å†µï¼Œè¿™ä¹Ÿä»…ä»…æ˜¯èƒ½è§£å†³<code>inject</code>å€¼ä¸æ˜¯å¿…è¦å€¼çš„æƒ…å†µ</p><p>ä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹æˆ‘ä»¬åˆ<strong>è¦æ±‚ç¥–å…ˆé“¾ä¸Šå¿…é¡»æä¾›éœ€è¦çš„<code>inject</code></strong>ï¼Œè¿™ç§æƒ…å†µæ›´å¸¸è§çš„æ˜¯é€šç”¨å‹ç»„ä»¶å¼€å‘ä¸­ã€‚ä¾‹å¦‚ï¼š<code>&lt;ElTable&gt;</code>å’Œ<code>&lt;ElTableColumn&gt;</code>ç»„ä»¶ï¼Œ<code>&lt;ElTableColumn&gt;</code>çš„ç¥–å…ˆé“¾ä¸Šå¿…é¡»å­˜åœ¨<code>&lt;ElTable&gt;</code>ç»„ä»¶ã€‚å¦‚æœå•ç‹¬ä½¿ç”¨<code>&lt;ElTableColumn&gt;</code>æ˜¯ä¸åˆæ³•çš„ï¼Œè¿™æ—¶å€™åº”è¯¥æŠ›å‡ºé”™è¯¯ âŒ è€Œä¸æ˜¯è­¦å‘Š âš ï¸</p><p>è¦è§£å†³ä¸Šé¢çš„ä¸¥æ ¼ä¾èµ–é—®é¢˜ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥åœ¨å­ç»„ä»¶ä¸­é€šè¿‡åˆ¤æ–­<code>inject</code>çš„å€¼æ˜¯å¦ä¸º<code>undefined</code>ï¼Œå¦‚æœæ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ç§ä»£ç å¾ˆç®€å•ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> curAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curAccount) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CurAccountKeyå¿…é¡»æä¾›å¯¹åº”çš„Provide&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curAccount.id;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å—¯ï¼Œä¸é”™ï¼æ˜¯è§£å†³äº†é—®é¢˜ï¼å¦‚æœä¸¥æ ¼ä¾èµ–çš„å¾ˆå¤šå‘¢ï¼Ÿéš¾ä¸æˆåˆ°å¤„éƒ½æ˜¯<code>if</code>åˆ¤æ–­ï¼Ÿ</p><h3 id="å®è·µæ–¹æ¡ˆ-2" tabindex="-1">å®è·µæ–¹æ¡ˆ <a class="header-anchor" href="#å®è·µæ–¹æ¡ˆ-2" aria-label="Permalink to &quot;å®è·µæ–¹æ¡ˆ&quot;">â€‹</a></h3><p>åˆ›å»ºä¸€ä¸ªä¸¥æ ¼æ³¨å…¥å·¥å…·å‡½æ•°ï¼Œå½“å¯¹åº”çš„æ³¨å…¥åæ²¡æœ‰è¢«æä¾›æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> injectStrict</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InjectionKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  defaultValue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  treatDefaultAsFactory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key, defaultValue, treatDefaultAsFactory);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Could not resolve \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">key</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">description</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>ä½¿ç”¨<code>injectStrict</code>é‡å†™å§ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> curAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> injectStrict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">curAccount.id;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="å†è°ˆé€çº§ç©¿é€" tabindex="-1">å†è°ˆé€çº§ç©¿é€ <a class="header-anchor" href="#å†è°ˆé€çº§ç©¿é€" aria-label="Permalink to &quot;å†è°ˆé€çº§ç©¿é€&quot;">â€‹</a></h2><p><strong>åœ¨ Vue ä¸­ Provide ç»„ä»¶æ— æ³•ä½¿ç”¨ provide å€¼</strong></p><p>è¿™ä¸ªçœ‹ç€æœ‰ç‚¹ç»•ï¼Œç›´è§‚æ¥çœ‹ä½¿ç”¨æƒ…å†µæ˜¯è¿™æ ·çš„ï¼š</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;youth&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey, user);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccount); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™é‡Œæ— æ³•è·å–ğŸ‘†æä¾›çš„user</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å“ï¼ŸğŸ˜¯ è¿™æ—¶å€™æœ‰çš„åŒå­¦è‚¯å®šä¼šè¯´ï¼ŒProvide ç»„ä»¶ä½¿ç”¨<code>provide</code>çš„å€¼ï¼Ÿæœ‰æ²¡æœ‰æé”™å•Šï¼Ÿæ€ä¹ˆä¼šæœ‰è¿™ç§æ“ä½œï¼Ÿ</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;youth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey, user);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//è¿™é‡Œéœ€è¦userå€¼çš„æ—¶å€™ï¼Œç›´æ¥ç”¨ä¸å°±å¥½äº†ï¼Ÿï¼Ÿ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="é€çº§é€ä¼ é—®é¢˜åˆæ¥äº†" tabindex="-1">é€çº§é€ä¼ é—®é¢˜åˆæ¥äº† <a class="header-anchor" href="#é€çº§é€ä¼ é—®é¢˜åˆæ¥äº†" aria-label="Permalink to &quot;é€çº§é€ä¼ é—®é¢˜åˆæ¥äº†&quot;">â€‹</a></h3><p>ä½†æ˜¯ï¼Œåˆ«å¿˜äº†è‡ªå®šä¹‰<code>hook</code>çš„æƒ…å†µå•Šï¼ï¼å¦‚æœ<code>provide(CurAccountKey, user);</code>æ˜¯åœ¨ä¸€ä¸ªè‡ªå®šä¹‰çš„<code>hook</code>ä¸­çš„å‘¢ï¼Ÿ</p><p><code>useAccount.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey, user);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { user };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¦‚æœæ˜¯ç›´æ¥è°ƒç”¨<code>useAccount</code>è¿˜ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸º<code>useAccount</code>è¿”å›äº†<code>user</code>ã€‚åœ¨è°ƒç”¨<code>userAccount</code>çš„åœ°æ–¹å¯ä»¥ç›´æ¥è§£æ„å‡º<code>user</code>ï¼Œè¿™æ ·å¾ˆç›´è§‚ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚</p><p><strong>å¦‚æœ<code>useAccount</code>è¢«å…¶ä»–çš„<code>hook</code>å†æ¬¡å°è£…å‘¢ï¼Ÿ</strong></p><p><code>useApp.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useApp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> account</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    account</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>å½“ç„¶ï¼Œè¿™ä¹Ÿä¸æ˜¯æ²¡æœ‰è§£å†³æ–¹æ³•ï¼Œå¯ä»¥åœ¨<code>useApp</code>ä¸­è§£æ„<code>account</code>å†è¿”å›</p><p><code>useApp.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useApp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> account</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">account</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/23514e7cc0e34ab1859166a95b2590bf~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt="image.png"></p><p>ç­‰ä¸‹ï¼Ÿæœ‰æ²¡æœ‰è§‰å¾—è¿™ç§æƒ…å†µå¾ˆç†Ÿæ‚‰ï¼Ÿæˆ‘ä»¬æŠŠ<code>hook</code>æ¢æˆç»„ä»¶ï¼Œæƒ…å†µæ˜¯ä¸æ˜¯å°±æ˜¯è¿™æ ·ï¼š</p><p><img src="https://qn.huat.xyz/mac/202309021953971.awebp" alt="image.png"></p><p>ä¸èƒ½è¯´ç›¸ä¼¼ï¼Œåªèƒ½è¯´ä¸€æ¯›ä¸€æ ·å•Šï¼<code>Provide/Inject</code>çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œä½†æ˜¯å½“åœ¨<code>hook</code>ä¸­å‡ºç°é€ä¼ æ—¶ï¼Œå´åˆæˆäº†æœ€åˆçš„æ ·å­å•Šï¼</p><p><strong>å± é¾™å‹‡å£«æœ€ç»ˆå˜æˆæ¶é¾™ï¼Ÿ</strong></p><p>ä½ å¯èƒ½ä¼šè¯´é‚£æ²¡åŠæ³•å‘€ï¼<strong>Vue æ— æ³•åœ¨å½“å‰ç»„ä»¶ä¸­è·å–åˆ°å½“å‰ç»„ä»¶çš„<code>provide</code></strong>ï¼Œè¿˜èƒ½æœ‰ä»€ä¹ˆå¥½æ‹›ï¼Ÿå…ˆ ğŸ¶ ç€å§ï¼</p><h3 id="å®è·µæ–¹æ¡ˆ-3" tabindex="-1">å®è·µæ–¹æ¡ˆ <a class="header-anchor" href="#å®è·µæ–¹æ¡ˆ-3" aria-label="Permalink to &quot;å®è·µæ–¹æ¡ˆ&quot;">â€‹</a></h3><p>è§£å†³ä¸Šé¢é—®é¢˜çš„æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è·å–å½“å‰ç»„ä»¶å®ä¾‹ï¼Œç„¶åä»ç»„ä»¶å®ä¾‹ä¸­æ‰¾åˆ°<code>provide</code>çš„å€¼å°±å¥½äº†ï¼</p><p>æ—¢ç„¶ Vue æœ¬èº«æ— æ³•æ”¯æŒå½“å‰ç»„ä»¶è·å–å½“å‰ç»„ä»¶çš„<code>provide</code>ï¼Œé‚£æˆ‘ä»¬è‡ªå·±å®ç°ä¸€ä¸ªå§ï¼</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { getCurrentInstance, inject, InjectionKey } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> injectWithSelf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InjectionKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vm</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getCurrentInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> vm?.provides[key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(key);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>è¿™é‡Œæˆ‘ä»¬<strong>ä»å½“å‰ç»„ä»¶çš„å®ä¾‹ä¸­æ‰¾åˆ°å¯¹åº” key çš„<code>provide</code>å€¼ï¼Œå¦‚æœä¸å­˜åœ¨å°±èµ°<code>inject</code>ä»ç¥–å…ˆé“¾ç»„ä»¶ä¸­è·å–</strong>ã€‚</p><p>ä½¿ç”¨<code>injectWithSelf</code>é‡å†™ä¸€ä¸‹å§ï¼š</p><p><code>useAccount.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAccount</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/**/*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  provide</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey, user);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { user };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>useApp.ts</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useApp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> account</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAccount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    account</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>Main.vue</code>:</p><div class="language-typescript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¿…é¡»åœ¨useApp()ä¹‹å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> injectWithSelf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CurAccountKey);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="æœ€å" tabindex="-1">æœ€å <a class="header-anchor" href="#æœ€å" aria-label="Permalink to &quot;æœ€å&quot;">â€‹</a></h2><ul><li><strong>ä½¿ç”¨<code>Symbol</code>æ¥åˆ›å»ºæ³¨å…¥åï¼Œæ¥å›é¿å–åå†²çª</strong></li><li><strong>ä½¿ç”¨ TS å’Œ<code>InjectionKey</code>å¯ä»¥æœ‰æ•ˆè§£å†³ç±»å‹æç¤ºé—®é¢˜</strong></li><li><strong>ä½¿ç”¨è‡ªå®šä¹‰<code>injectStrict</code>å¯ä»¥è§£å†³ä¸¥æ ¼æ³¨å…¥é—®é¢˜</strong></li><li><strong>ä½¿ç”¨è‡ªå®šä¹‰<code>injectWithSelf</code>å¯ä»¥è§£å†³<code>hook</code>åµŒå¥—æ—¶çš„è¿”å›å€¼é€çº§ç©¿é€é—®é¢˜</strong></li></ul><p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ åœ¨å¼€å‘ä¸­æœ‰æ‰€å¸®åŠ©ï¼Œéº»çƒ¦å¤šç‚¹èµè¯„è®ºæ”¶è— ğŸ˜Š</p><p>å¦‚æœ...ï¼Œéº»çƒ¦å¤šç‚¹èµè¯„è®ºæ”¶è— ğŸ˜Š</p><p><img src="https://qn.huat.xyz/mac/202309021954096.awebp" alt="image.png"></p>`,99),t=[p];function l(h,k,r,c,d,o){return a(),i("div",null,t)}const E=s(e,[["render",l]]);export{g as __pageData,E as default};
