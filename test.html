<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.js"></script>
  <style>
    body {
      height: 200vh;
    }
  </style>
</head>

<body>
  <script>

    /**
    function t(str) {
      const arr = str.split('.')

      let result = {}

      let p = result

      arr.forEach((key, index) => {

        p[key] = {}

        if (index === arr.length - 1) {
          p[key] = null
        }

        p = p[key]
      })


      return result
    }


    console.log(t("a.b.c"));


    function transformStr(str) {
      const arr = str.split(".");
      let result = {};
      let p = result;

      arr.forEach((key, index) => {
        p[key] = {};

        if (index === arr.length - 1) {
          p[key] = null;
        }

        p = p[key];
      });

      return result;
    }

    const result = transformStr("a.b.c")

    console.log(result);

    function walk(obj) {
      let str = ''
      let p = obj

      while (p) {
        const keys = Object.keys(p)

        keys.forEach((key) => {
          str = str ? (str + '.' + key) : (str + key)
          p = p[key];
          console.log(p);
        });

      }

      return str
    }

*/

    // setTimeout(() => {
    //   const res =  walk(result)
    //   console.log('res', res.toString());
    // }, 1000);


    // 输入 "a.b,1\na.c,2\nd,3"（其中 \n 是换行符）应该返回 {a: {b: 1, c: 2}, d: 3}。
      function csvToNestedObject(str) {
        const result = {}
        const res = []
        const strArr = str.split('\n')
        console.log(strArr);



        strArr.forEach(item => {
          const arr = item.split(',')
          res.push(arr)
        });
        console.log(res);

        res.forEach(item => {
          const pathArr = item[0].split('.')
          const val = item[1]

          let p = result


          pathArr.forEach((key, i) => {
            if (i === pathArr.length - 1) {
              p[key] = val
            } else {
              p[key] = p[key] || {}
              p = p[key]
            }
          })
        })


        return result
      }

      console.log(csvToNestedObject('a.b,1\na.c,2\nd,3'));


      const promise = new Promise((resolve, reject) => {
    console.log(1);
    console.log(2);
});

promise.then(() => {
    console.log(3);
});

console.log(4);

  </script>
</body>

</html>